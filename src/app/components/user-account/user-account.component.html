<div class="container pt-5">
  <div class="d-flex justify-content-between mb-3">
    <h3>Total amount - {{totalAmount | currency: 'INR'}}</h3>
    <button type="button" class="btn btn-dark" (click)="onAddClick()" [disabled]="isAddOperation || isEditOperation">
      Add Account
    </button>
  </div>

  <ng-container *ngIf="userAccounts.length > 0 || isAddOperation">
    <form [formGroup]="accountForm">
      <div class="table-responsive">
        <table class="table table-bordered table-hover">
          <thead>
            <tr>
              <th class="text-center">Sr No</th>
              <th>Name</th>
              <th>Amount</th>
              <th class="text-center">Delete</th>
            </tr>
          </thead>
          <tbody class="cursor-pointer">
            <ng-container *ngFor="let userAccount of userAccounts; let i = index">
              <ng-container *ngIf="!userAccount.isEditClicked">
                <tr (click)="onEditClick(userAccount)">
                  <td class="text-center">{{ i + 1}}</td>
                  <td>{{userAccount.name}}</td>
                  <td>{{userAccount.amount}}</td>
                  <td class="text-center">
                    <button class="btn" type="button" (click)="onDeleteClick($event, userAccount)">
                      <i class="material-icons-outlined text-danger">delete</i>
                    </button>
                  </td>
                </tr>
              </ng-container>
              <ng-container *ngIf="userAccount.isEditClicked && isEditOperation">
                <tr class="no-hover">
                  <td class="text-center">
                    <button type="submit" class="btn" (click)="onSubmitClick()">
                      <i class="material-icons-outlined">check_circle</i>
                    </button>
                  </td>
                  <td>
                    <input type="text" class="form-control" formControlName="name" placeholder="Eg: My Account"
                      [ngClass]="(accountForm.get('name')!.touched || accountForm.get('name')!.dirty) && 
                    accountForm.get('name')!.invalid ? 'is-invalid' : ''" maxlength="255">
                    <div *ngIf="(accountForm.get('name')!.touched || accountForm.get('name')!.dirty) && 
                      accountForm.get('name')!.invalid">
                      <div *ngIf="accountForm.get('name')!.errors!['required']" class="invalid-control">
                        Account name must be specified
                      </div>
                    </div>
                  </td>
                  <td>
                    <input type="number" class="form-control" formControlName="amount" placeholder="Eg: 10000"
                      [ngClass]="(accountForm.get('amount')!.touched || accountForm.get('amount')!.dirty) && 
                    accountForm.get('amount')!.invalid ? 'is-invalid' : ''">
                    <div *ngIf="(accountForm.get('amount')!.touched || accountForm.get('amount')!.dirty) && 
                      accountForm.get('amount')!.invalid">
                      <div *ngIf="accountForm.get('amount')!.errors!['required']" class="invalid-control">
                        Amount must be specified
                      </div>
                    </div>
                  </td>
                  <td class="text-center">
                    <button type="reset" class="btn" (click)="cancelEdit(userAccount)">
                      <i class="material-icons-outlined">cancel</i>
                    </button>
                  </td>
                </tr>
              </ng-container>
            </ng-container>
            <ng-container *ngIf="isAddOperation">
              <tr class="no-hover">
                <td class="text-center">
                  <button type="submit" class="btn" (click)="onSubmitClick()">
                    <i class="material-icons-outlined">check_circle</i>
                  </button>
                </td>
                <td>
                  <input type="text" class="form-control" formControlName="name" placeholder="Eg: My Account">
                </td>
                <td>
                  <input type="number" class="form-control" formControlName="amount" placeholder="Eg: 10000">
                </td>
                <td class="text-center">
                  <button type="reset" class="btn" (click)="cancelAdd()">
                    <i class="material-icons-outlined">cancel</i>
                  </button>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </form>
  </ng-container>
</div>


<ng-template #messageTemplate>
  <span class="toast-font"><strong>{{message}}</strong></span>
</ng-template>

<ng-template #deleteModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title">Delete Confirmation</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss()"></button>
  </div>

  <div class="modal-body">
    <h4>Are you sure you want to continue?</h4>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-outline-success">Yes</button>
    <button type="button" class="btn btn-outline-danger">No</button>
  </div>
</ng-template>